import sys
sys.path.append(r"C:\Users\davla\OneDrive\Documents\GitHub\-_-\src")
from lib import *
import csv

def write_csv(freq_dict: dict, filename: str):
    sorted_items = sorted(freq_dict.items(), key=lambda x: (-x[1], x[0]))
    
    with open(filename, 'w', newline='', encoding='utf-8') as csvfile:
        writer = csv.writer(csvfile)
        writer.writerow(['word', 'count'])
        for word, count in sorted_items:
            writer.writerow([word, count])

def task_b(text: str):
    norm_t = tokenize(normalize(text))
    count_t = count_freq(norm_t)
    write_csv(count_t, r"C:\Users\davla\OneDrive\Documents\GitHub\-_-\data\report.csv")
    return table(text)

print(task_b(read_text(r"C:\Users\davla\OneDrive\Documents\GitHub\-_-\data\input.txt")))